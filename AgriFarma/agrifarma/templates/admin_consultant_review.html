{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
  <h2>Admin: Consultant Applications</h2>

  <h4 class="mt-3">Pending Applications</h4>
  {% if pending %}
    <div class="table-responsive">
      <table class="table table-striped align-middle">
        <thead>
          <tr>
            <th>User</th>
            <th>Category</th>
            <th>Expertise</th>
            <th>Contact</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for cons in pending %}
            <tr>
              <td>{{ cons.user.profile.name if cons.user.profile else cons.user.email }}</td>
              <td>{{ cons.category.replace('_',' ').title() }}</td>
              <td>{{ cons.expertise_level.title() }}</td>
              <td><a href="mailto:{{ cons.contact_email }}">{{ cons.contact_email }}</a></td>
              <td>
                <form method="post" class="d-inline">
                  {{ csrf_token() }}
                  <input type="hidden" name="consultant_id" value="{{ cons.id }}" />
                  <input type="hidden" name="action" value="approve" />
                  <button class="btn btn-success btn-sm">Approve</button>
                </form>
                <form method="post" class="d-inline ms-1">
                  {{ csrf_token() }}
                  <input type="hidden" name="consultant_id" value="{{ cons.id }}" />
                  <input type="hidden" name="action" value="reject" />
                  <button class="btn btn-outline-danger btn-sm">Reject</button>
                </form>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <div class="alert alert-secondary">No pending applications.</div>
  {% endif %}

  <h4 class="mt-4">Recently Approved</h4>
  {% if approved %}
    <div class="row">
      {% for cons in approved %}
        <div class="col-md-4 mb-3">
          <div class="card h-100">
            <div class="card-body">
              <h5 class="card-title">{{ cons.user.profile.name if cons.user.profile else cons.user.email }}</h5>
              <p class="mb-1"><strong>Category:</strong> {{ cons.category.replace('_',' ').title() }}</p>
              <p class="mb-1"><strong>Expertise:</strong> {{ cons.expertise_level.title() }}</p>
              <p class="mb-0"><strong>Email:</strong> <a href="mailto:{{ cons.contact_email }}">{{ cons.contact_email }}</a></p>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="alert alert-secondary">No approved consultants yet.</div>
  {% endif %}
</div>
{% endblock %}
